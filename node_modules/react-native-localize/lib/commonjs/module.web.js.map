{"version":3,"sources":["module.web.js"],"names":["getLocaleFromLanguageTag","languageTag","countryCodeFallback","splitted","split","languageCode","countryCode","isRTL","USES_RTL_LAYOUT","includes","generateConstants","languageTags","base","currencies","locales","numberFormatter","Intl","NumberFormat","dateFormatter","DateTimeFormat","hour","forEach","locale","currency","CURRENCIES","find","_","push","numberSeparators","format","replace","numberFormatSettings","decimalSeparator","length","groupingSeparator","eveningDate","Date","uses24HourClock","match","calendar","country","temperatureUnit","USES_FAHRENHEIT","timeZone","resolvedOptions","usesMetricSystem","USES_IMPERIAL","handlers","Set","constants","navigator","languages","window","addEventListener","handler"],"mappings":"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","sourcesContent":["// @flow\n\nimport {\n  USES_FAHRENHEIT,\n  USES_IMPERIAL,\n  USES_RTL_LAYOUT,\n  CURRENCIES,\n} from \"./constants\";\n\nimport type { Locale, LocalizationConstants } from \"./types\";\n\nfunction getLocaleFromLanguageTag(\n  languageTag: string,\n  countryCodeFallback: string,\n): Locale {\n  const splitted = languageTag.split(\"-\");\n  const languageCode = splitted[0];\n\n  if (splitted[1] === \"419\") {\n    splitted[1] = \"UN\"; // overwrite Latin America and Caribbean region\n  }\n\n  const countryCode = splitted[1] || countryCodeFallback;\n\n  return {\n    languageCode: languageCode,\n    countryCode,\n    languageTag: `${languageCode}-${countryCode}`,\n    isRTL: USES_RTL_LAYOUT.includes(languageCode),\n  };\n}\n\nfunction generateConstants(\n  languageTags: $ReadOnlyArray<string>,\n): LocalizationConstants {\n  const base = getLocaleFromLanguageTag(languageTags[0], \"US\");\n\n  const currencies: string[] = [];\n  const locales: Locale[] = [];\n\n  const numberFormatter = new Intl.NumberFormat(base.languageTag);\n  const dateFormatter = new Intl.DateTimeFormat(base.languageTag, {\n    hour: \"numeric\",\n  });\n\n  languageTags.forEach(languageTag => {\n    const locale = getLocaleFromLanguageTag(languageTag, base.countryCode);\n    const currency = CURRENCIES[locale.countryCode] || \"USD\";\n\n    if (!locales.find(_ => _.languageTag === locale.languageTag)) {\n      locales.push(locale);\n    }\n    if (!currencies.includes(currency)) {\n      currencies.push(currency);\n    }\n  });\n\n  const numberSeparators = [\n    ...numberFormatter.format(1000000.1).replace(/\\d/g, \"\"),\n  ];\n  const numberFormatSettings = {\n    decimalSeparator: numberSeparators[numberSeparators.length - 1],\n    groupingSeparator: numberSeparators[0],\n  };\n\n  const eveningDate = new Date(2000, 0, 1, 20);\n  const uses24HourClock = !!dateFormatter.format(eveningDate).match(/am|pm/i);\n\n  return {\n    calendar: \"gregorian\",\n    country: base.countryCode,\n    currencies,\n    locales,\n    numberFormatSettings,\n    temperatureUnit: USES_FAHRENHEIT.includes(base.countryCode)\n      ? \"fahrenheit\"\n      : \"celsius\",\n    timeZone: dateFormatter.resolvedOptions().timeZone || \"Etc/UTC\",\n    uses24HourClock,\n    usesMetricSystem: !USES_IMPERIAL.includes(base.countryCode),\n  };\n}\n\nexport const handlers: Set<Function> = new Set();\nexport let constants: LocalizationConstants = generateConstants(\n  navigator.languages,\n);\n\nwindow.addEventListener(\"languagechange\", () => {\n  constants = generateConstants(navigator.languages);\n  handlers.forEach(handler => handler());\n});\n"]}